<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Генератор и Проверка Паролей</title>
    <style>
        /* ... (предыдущие стили остаются без изменений) ... */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px;
            background: #28a745;
            color: white;
            border-radius: 4px;
            display: none;
            z-index: 1000;
        }
        .toast.error { background: #dc3545; }
    </style>
</head>
<body>
    <div id="toast" class="toast"></div>
    
    <div class="container">
        <!-- ... (остальная разметка остается без изменений) ... -->
    </div>

    <script>
        // Toast-уведомления
        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${isError ? 'error' : ''}`;
            toast.style.display = 'block';
            setTimeout(() => toast.style.display = 'none', 3000);
        }

        // Модифицированная функция copyPassword
        function copyPassword() {
            const passwordElement = document.getElementById('generatedPassword');
            if(passwordElement) {
                navigator.clipboard.writeText(passwordElement.innerText)
                    .then(() => showToast('Пароль скопирован!'))
                    .catch(() => showToast('Не удалось скопировать', true));
            }
        }

        // Обновленная функция generatePassword
        async function generatePassword() {
            const resultDiv = document.getElementById('generationResult');
            resultDiv.innerHTML = '<div class="status-item">Генерация...</div>';

            try {
                const length = parseInt(document.getElementById('length').value);
                if (isNaN(length) || length < 8 || length > 100) {
                    throw new Error('Некорректная длина пароля (8-100)');
                }

                const options = Array.from(document.querySelectorAll('input[name="option"]:checked'))
                    .map(el => el.value);

                if(useCustomCharset) {
                    options.push('OPT_CUSTOM_CHARSET');
                    const customChars = document.getElementById('customCharset').value;
                    if (new Set(customChars).size < 4) {
                        throw new Error('Набор символов должен содержать минимум 4 уникальных символа');
                    }
                }

                const response = await fetch('/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        length,
                        options,
                        separator: '-',
                        custom_charset: document.getElementById('customCharset').value
                    })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    const strengthMap = { /* ... (как было раньше) ... */ };
                    // ... (остальная часть как было) ...
                } else {
                    resultDiv.innerHTML = `<div class="status-item error">Ошибка: ${data.error || 'Неизвестная ошибка'}</div>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="status-item error">
                        Ошибка: ${error.message || 'Ошибка соединения'}
                    </div>
                `;
                showToast(error.message || 'Ошибка соединения', true);
            }
        }

        // Обновленная функция checkPassword
        async function checkPassword() {
            const password = document.getElementById('passwordToCheck').value.trim();
            const resultDiv = document.getElementById('checkResult');
            resultDiv.innerHTML = '<div class="status-item">Проверка...</div>';

            if (!password) {
                resultDiv.innerHTML = '<div class="status-item error">Введите пароль для проверки</div>';
                showToast('Введите пароль для проверки', true);
                return;
            }

            try {
                const response = await fetch('/check', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ password })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    // ... (остальная часть как было) ...
                } else {
                    resultDiv.innerHTML = `<div class="status-item error">Ошибка: ${data.error || 'Неизвестная ошибка'}</div>`;
                }
            } catch (error) {
                resultDiv.innerHTML = '<div class="status-item error">Ошибка соединения</div>';
                showToast('Ошибка соединения с сервером', true);
            }
        }

        // ... (остальные функции остаются без изменений) ...
    </script>
</body>
</html>
