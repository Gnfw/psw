<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Security Toolkit</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .hero { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .password-field { position: relative; }
        .toggle-password { position: absolute; right: 10px; top: 50%; transform: translateY(-50%); cursor: pointer; }
        .box:hover { transform: translateY(-5px); transition: all 0.3s ease; }
        .footer { background-color: #f5f5f5; padding: 2rem 1.5rem; }
        .notification { margin-top: 1rem; }
    </style>
</head>
<body>
    <section class="hero is-medium">
        <div class="hero-body">
            <div class="container has-text-centered">
                <h1 class="title has-text-white">Password Security Toolkit</h1>
                <p class="subtitle has-text-white">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –∞–Ω–∞–ª–∏–∑ –Ω–∞–¥—ë–∂–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π</p>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container">
            <!-- –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–∞—Ä–æ–ª–µ–π -->
            <div class="box">
                <h2 class="title is-4">üîê –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–∞—Ä–æ–ª–µ–π</h2>
                <div class="field">
                    <label class="label">–î–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è</label>
                    <div class="control">
                        <input class="input" type="number" id="length" min="8" max="100" value="12">
                    </div>
                </div>

                <div class="field">
                    <label class="label">–û–ø—Ü–∏–∏</label>
                    <div class="columns is-multiline">
                        <div class="column is-4">
                            <label class="checkbox">
                                <input type="checkbox" class="option" value="OPT_LOWERCASE" checked>
                                –°—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã (a-z)
                            </label>
                        </div>
                        <div class="column is-4">
                            <label class="checkbox">
                                <input type="checkbox" class="option" value="OPT_UPPERCASE">
                                –ó–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã (A-Z)
                            </label>
                        </div>
                        <div class="column is-4">
                            <label class="checkbox">
                                <input type="checkbox" class="option" value="OPT_DIGITS" checked>
                                –¶–∏—Ñ—Ä—ã (0-9)
                            </label>
                        </div>
                        <div class="column is-4">
                            <label class="checkbox">
                                <input type="checkbox" class="option" value="OPT_SPECIAL">
                                –°–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã (!@#...)
                            </label>
                        </div>
                        <div class="column is-4">
                            <label class="checkbox">
                                <input type="checkbox" class="option" value="OPT_NO_DIGITS">
                                –ò—Å–∫–ª—é—á–∏—Ç—å —Ü–∏—Ñ—Ä—ã
                            </label>
                        </div>
                        <div class="column is-4">
                            <label class="checkbox">
                                <input type="checkbox" class="option" value="OPT_AVOID_SIMILAR">
                                –ò—Å–∫–ª—é—á–∏—Ç—å –ø–æ—Ö–æ–∂–∏–µ —Å–∏–º–≤–æ–ª—ã
                            </label>
                        </div>
                        <div class="column is-4">
                            <label class="checkbox">
                                <input type="checkbox" class="option" value="OPT_SEPARATORS">
                                –î–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏
                            </label>
                        </div>
                        <div class="column is-4">
                            <label class="checkbox">
                                <input type="checkbox" class="option" value="OPT_NO_REPEAT">
                                –ë–µ–∑ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å–∏–º–≤–æ–ª–æ–≤
                            </label>
                        </div>
                    </div>
                </div>

                <div class="field">
                    <button class="button is-primary is-fullwidth" onclick="generatePassword()">
                        –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å
                    </button>
                </div>

                <div class="password-field field has-addons">
                    <div class="control is-expanded">
                        <input class="input generated-password" type="text" readonly id="generated-password">
                    </div>
                    <div class="control">
                        <button class="button is-info" onclick="copyPassword()">
                            <span class="icon"><i class="fas fa-copy"></i></span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è -->
            <div class="box">
                <h2 class="title is-4">üõ°Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è</h2>
                <div class="password-field field">
                    <div class="control is-expanded">
                        <input class="input" type="password" id="check-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏">
                        <span class="toggle-password" onclick="togglePasswordVisibility()">
                            <i class="fas fa-eye"></i>
                        </span>
                    </div>
                </div>
                <button class="button is-info is-fullwidth" onclick="checkPassword()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                
                <div id="result" class="mt-4">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="content has-text-centered">
            <h3 class="title is-5">üîç –û —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</h3>
            <div class="columns">
                <div class="column">
                    <p class="has-text-weight-bold">–≠–Ω—Ç—Ä–æ–ø–∏—è –ø–∞—Ä–æ–ª—è</p>
                    <p>–ú–µ—Ä–∞ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏, –≤—ã—á–∏—Å–ª—è–µ–º–∞—è –∫–∞–∫ log‚ÇÇ(N·¥∏), –≥–¥–µ:
                        <br>N - —Ä–∞–∑–º–µ—Ä –Ω–∞–±–æ—Ä–∞ —Å–∏–º–≤–æ–ª–æ–≤
                        <br>L - –¥–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è
                    </p>
                </div>
                <div class="column">
                    <p class="has-text-weight-bold">–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã</p>
                    <ul>
                        <li>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ secrets API</li>
                        <li>–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ç–µ—á–µ–∫ —á–µ—Ä–µ–∑ PwnedPasswords</li>
                        <li>–ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <script>
        const API_URLS = {
            GENERATE: '/generate',
            CHECK: '/check'
        };

        const optionsMap = {
            'OPT_LOWERCASE': 1 << 0,
            'OPT_UPPERCASE': 1 << 1,
            'OPT_DIGITS': 1 << 2,
            'OPT_SPECIAL': 1 << 3,
            'OPT_NO_DIGITS': 1 << 4,
            'OPT_SEPARATORS': 1 << 5,
            'OPT_FULLASCII': 1 << 6,
            'OPT_AVOID_SIMILAR': 1 << 7,
            'OPT_NO_REPEAT': 1 << 8,
            'OPT_RANDOM_CASE': 1 << 9,
            'OPT_CUSTOM_CHARSET': 1 << 10,
            'OPT_LANGUAGE_SPECIFIC': 1 << 11,
            'OPT_OUTPUT_FORMAT': 1 << 12
        };

        async function generatePassword() {
            try {
                const options = Array.from(document.querySelectorAll('.option:checked'))
                    .map(checkbox => checkbox.value)
                    .reduce((acc, val) => acc | optionsMap[val], 0);

                const length = parseInt(document.getElementById('length').value) || 12;

                const response = await fetch(API_URLS.GENERATE, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ length, options: Object.keys(optionsMap).filter(key => (options & optionsMap[key]) !== 0) })
                });

                if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏');
                
                const data = await response.json();
                document.getElementById('generated-password').value = data.password;
                showNotification('–ü–∞—Ä–æ–ª—å —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω!', 'is-success');

            } catch (error) {
                showNotification(error.message, 'is-danger');
            }
        }

        async function checkPassword() {
            try {
                const password = document.getElementById('check-password').value;
                if (!password) return;

                const response = await fetch(API_URLS.CHECK, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ password })
                });

                if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏');
                
                const result = await response.json();
                displayCheckResult(result);

            } catch (error) {
                showNotification(error.message, 'is-danger');
            }
        }

        function displayCheckResult(result) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `
                <div class="notification ${getStrengthClass(result.strength)}">
                    <h4 class="title is-5">–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏</h4>
                    <p><strong>–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:</strong> ${result.strength}</p>
                    <p><strong>–≠–Ω—Ç—Ä–æ–ø–∏—è:</strong> ${result.entropy} –±–∏—Ç</p>
                    <p><strong>–í—Ä–µ–º—è –≤–∑–ª–æ–º–∞:</strong> ${formatTime(result.time_to_crack)}</p>
                    <p><strong>–£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö:</strong> ${result.compromised ? '‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞' : '‚úÖ –ù–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞'}</p>
                    
                    ${result.warnings.length ? `
                    <div class="mt-3">
                        <p class="has-text-weight-bold">–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:</p>
                        <ul>${result.warnings.map(w => `<li>‚Ä¢ ${w}</li>`).join('')}</ul>
                    </div>` : ''}
                    
                    <div class="mt-3">
                        <p class="has-text-weight-bold">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</p>
                        <p>${result.recommendation}</p>
                    </div>
                </div>
            `;
        }

        function copyPassword() {
            const passField = document.getElementById('generated-password');
            navigator.clipboard.writeText(passField.value).then(() => {
                showNotification('–ü–∞—Ä–æ–ª—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!', 'is-success');
            });
        }

        function togglePasswordVisibility() {
            const passField = document.getElementById('check-password');
            const icon = document.querySelector('.toggle-password i');
            passField.type = passField.type === 'password' ? 'text' : 'password';
            icon.classList.toggle('fa-eye-slash');
        }

        function getStrengthClass(strength) {
            const classes = {
                '–°–ª–∞–±—ã–π': 'is-danger',
                '–°—Ä–µ–¥–Ω–∏–π': 'is-warning',
                '–ù–∞–¥–µ–∂–Ω—ã–π': 'is-success',
                '–û—á–µ–Ω—å –Ω–∞–¥–µ–∂–Ω—ã–π': 'is-primary',
                '–£–ª—å—Ç—Ä–∞ –Ω–∞–¥–µ–∂–Ω—ã–π': 'is-info'
            };
            return classes[strength] || '';
        }

        function formatTime(seconds) {
            if (seconds < 1) return '–º–≥–Ω–æ–≤–µ–Ω–Ω–æ';
            const units = [
                {name: '–ª–µ—Ç', div: 31536000},
                {name: '–º–µ—Å—è—Ü–µ–≤', div: 2592000},
                {name: '–¥–Ω–µ–π', div: 86400},
                {name: '—á–∞—Å–æ–≤', div: 3600},
                {name: '–º–∏–Ω—É—Ç', div: 60}
            ];
            
            for (const unit of units) {
                if (seconds >= unit.div) {
                    return `${Math.floor(seconds/unit.div)} ${unit.name}`;
                }
            }
            return `${Math.round(seconds)} —Å–µ–∫—É–Ω–¥`;
        }

        function showNotification(text, type = 'is-info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = text;
            
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }
    </script>
</body>
</html>
